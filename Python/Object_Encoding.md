# **객체부호화(Object Encoding)**

<br>

부호화란 **'데이터를 저장하거나 전송하기 쉽게 변환'** 하는 과정을 말한다. 그렇다면 객체부호화는 앞에서 데이터를을 객체로 바꾸면 될 것이다. 그렇다면 객체부호화를 하는 이유는 무엇일까?

*예를 들어 내가 만든 머신러닝 모델을 다른 사람에게 보내줘야 한다면 어떻게 보내야 할까? 코드를 그대로 보내야 할까? 그렇다면 받은 사람은 모델을 다시 학습시켜야 할 것이다. 이때 객체부호화를 사용하여 모델이라는 객체 자체를 보내줄 수 있는데, 바로 이러한 이유로 객체부호화를 사용하는 것이다.*

<br>
<br>
<hr>
<br>

## **1. 인메모리 방식, 바이트열 방식**

<br>

*객체부호화를 알기 전에 우선 객체가 어떤 방식으로 존재할 수 있는 지 알아보자. 객체는 크게 **인메모리 방식**과, **바이트열 방식**으로 존재할 수 있다.*

<br>

### *인메모리 방식*
:우리가 컴퓨터에서 파이썬으로 코드를 작성하여 작동시키면 이는 컴퓨터의 메모리 안에서 작동되는 것이다. 즉, 메모리가 읽을 수 있는 인메모리 방식으로 존재하는 것이다.

<br>

### *바이트열 방식*
: 데이터를 파일에 쓰거나 네트워크에서 전동되기 위한 표현 방식.

<br>

우리가 '**객체부호화'** 를 한다는 건 인메모리 방식에서 바이트열 방식으로 변환하는 걸 말한다. 반대로 바이트열 방식에서 인모메로 방식으로 변환하는 것을 **'복호화'** 라고 한다. 부호화와 복호화를 표현하는 단어는 여러가지가 있는데 아래와 같다.

<br>

* *부호화, 인코딩, 직렬화, 마샬링, 피클링*
* *복호화, 디코딩, 역직렬화, 언마샬링, 언피클링*

<br>
<br>
<hr>
<br>

## **2. Pickle**

<br>

오늘은 python 라이브러리인 `pickle`을 사용하여 객체부호화를 진행하는 것을 배웠다. 위에 부호화를 **'피클링'** 이라고 말하기도 한다고 했는데, `pickle` 라이브러리를 사용해서 부호화 하는 것을 **'피클링'** 이라고 말하기 때문이다.

내가 어떤 머신러닝 모델을 만들고 (`model`) 피클링하는 방법은 아래와 같다.

<br>

~~~python
import pickle

with open('model.pkl', 'wb') as pickle_file:
    pickle.dump(model, pickle_file)
~~~

<br>

위의 코드는 `model.pkl`이라는 파일을 `wb`(바이트형 쓰기모드)객체로 만든 후 모델을 피클링한 것이다. 이 과정을 거치면 `model.pkl`이라는 파일이 생성된 걸 볼 수 있다.

이후 이 파일을 같이 작업하는 팀원에게 보내주면 다시 학습하지 않아도 모델을 사용할 수 있게 된다. 그럼 이 파일을 받은 팀원은 그냥 저 파일을 실행시키기만 하면 될까? 당연히 아니다. **언피클링(복호화) 과정을 거쳐야 모델을 사용할 수 있게 된다.** 복호화는 load 함수를 이용하여 진행할 수 있다.

<br>

~~~python
import pickle

model = None

with open('model.pkl', 'rb') as pickle_file:
    model = pickle.load(pickle_file)
# wb가 쓰는 것이었다면, 여기서 rb는 읽는 것이다.
~~~

<br>
<br>
<hr>
<br>

## **3. JSON 파일 부호화**

<br>

JSON 파일을 부호화하는 방법은 피클링과 매우 유사하다. **다만 JSON의 경우 항상 str 객체를 생성하기에 `wb` 방식이 아닌 `w` 방식을 사용해야 한다.**

<br>

~~~python
data = {
    "test" : {
        "score" : "A",
        "grade" : "3"
    }
}

import json

# 부호화 뒤, 객체에 읽을 때
json_data = json.dump(data)

# 부호화 뒤, 파일에 쓸 때
with open('json_file.json', 'w') as json_file:
    json.dump(data, json_file)
~~~

<br>

복호화 하는 방법은 아래와 같다.

<br>

~~~python
import json

str_obj = None

with open('json_file.json', 'r') as json_file:
    str_obj = json.load(json_file)
~~~