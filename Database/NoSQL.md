# **NoSQL (Not Only SQL)**

<br>

## **1. NoSQL의 등장**

<br>

데이터베이스는 크게 관계형 데이터베이스(RDB)와 비관계형 데이터베이스(NoSQL)로 나눌 수 있다. 그럼 NoSQL은 왜 등장하게 된 것일까?

<br>

NoSQL의 등장은 **'웹'** 과 분산 컴퓨팅에서 말하는 **'클러스팅'** 의 발전으로 인해 등장하게 되었다. 웹이 빠르게 발전하면서 많은 데이터가 웹에 쏟아자기 시작했고 이를 RDB를 사용해서 다루기엔 서버를 확장할 필요가 있었다. 또한 클러스팅 기술이 발전하면서 하나의 서버를 크게 만드는 **수직적 확장**(더 좋은 CPU...)보다 가격이 저렴한 여러 서버를 연결하여 확장하는 **수평적 확장**의 방법이 더 비용을 절감시켜주기 시작했다. 이러한 배경으로 인해 수평적 확장에 용이한 NoSQL이 등장하게 되었다.

<br>
<hr>
<br>

## **2. RDB vs NoSQL**

<br>

### *1) 스키마*
*:
RDB의 경우 데이터를 적재하기 전에 스키마를 작성하지만, NoSQL의 경우 데이터를 형식에 구애 받지 않고 **일단 적재한다.***

<br>

RDB는 스키마를 작성하기에 데이터를 제대로만 적재한다면 꺼내기가 수월하다. 반면 고도로 복잡한 데이터의 경우 스키마를 작성하는 데 시간이 매우 오래 걸린다는 불편함이 있다. 또한 스키마를 변경할 경우 전체 데이터베이스를 수정하거나 오프라인으로 전환해야 한다.

NoSQL은 RDB에 비해 스키마가 유연하다. 그렇기에 행을 추가하면서 열을 추가할 수도 있다. 이러한 장점으로 인해 빠르게 프로토타입을 출시해야 하는 경우 더 유용할 수 있다. 그렇다고 NoSQL에 스키마가 아예 없는 것은 아니다. 데이터를 읽어올 때 스키마에 따라 읽어오기 때문이다.

<br>

### *2) 데이터 저장*
*: RDB의 경우 작성한 스키마를 기반으로 해서 테이블에 데이터를 저장한다. NoSQL의 경우 key-value, 문서형, wide-column, graph 등의 형식으로 저장한다.*


<br>

### *2) 쿼리*
*: RDB의 경우 구조화된 언어인 SQL을 사용하여 요청한다. 비관계형 데이터베이스의 경우 데이터 그룹 자체를 조회하는 것에 초점을 두고 있기에 구조화되지 않은 쿼리 언어로 요청이 가능하다.*

<br>

### *3) 확장성*
*: 앞에서 말했듯 RDB는 수직적 확장을 하고 비관계형 데이터베이스는 수평적 확장을 한다. (수평적 확장이 비용이 더 저렴하다.)*

<br>

### *4) 속도*
*: RDB의 경우 트랜잭션의 안정성을 보장해주는 ACID 성질로 인해 한번의 여러 요청이 들어왔을 때 비관계형 데이터베이스에 비해 처리가 느릴 수 있다. (관계형 데이터베이스가 성능이 더 좋은 사례도 있다고 함.) 그렇기에 안정성이 중요한 경우에는 관계형 데이터베이스가 선호된다. (전자 상거래, 금융 서비스 등) 반면 NoSQL의 경우 ACID 성질을 준수하지 않기에 비교적 처리 속도가 빠르다. 그렇기에 데이터의 형식에 구애받지 않고 많은 데이터를 적재하는게 중요한 경우 유용하게 사용할 수 있다*

<br>
<hr>
<br>

## **3. MongoDB**

<br>

비관계형 데이터베이스 타입은 key-value, 문서형, wide-column, graph가 있는데, **MongoDB는 문서형 데이터베이스이다.**

*문서형 데이터베이스는 데이터를 **문서처럼 작성하는 데이터베이스이다.** 여기서 **문서는 하나의 속성에 대한 데이터를 가지고 있고** JSON과 유사한 형식으로 데이터를 문서화하는 것이 보통이다. 또한 이러한 **문서를 그룹으로 묶어서 관리하는 컬렉션이 존재한다.***

<br>

### ***MongoDB 생성 후 Python과 연결.***

<br>

우선 클라우드 데이터베이스 서비스인 MongoDB Atlas에 클러스터를 생성한다. 파이썬에서 MongoDB를 다루기 위해선 pymongo를 사용한다. 

처음으로 해줘야할 작업은 데이터베이스에 연결해줄 클라이언트인 `MongcoClient` 를 불러오고 클라이언트를 생성하는 것이다. URI를 통해 클라이언트를 생성해보자.

<br>

~~~python
from pymongo import MongoClient

URI = 'mongodb+srv://{유저 이름}:{비밀 번호}@{호스트}/{데이터베이스 이름}?retryWrites=true&w=majority'

client = MongoClient(URI)
~~~

<br>

이후에는 데이터베이스를 생성하고 콜렉션을 생성하면 된다.

<br>

~~~python
db = client['db'] # [] 안에는 데이터베이스의 이름을 넣어주면 된다.
collection = db['collection'] # [] 마찬가지로 콜렉션 이름.

# 해당 방식으로 각각의 db와 collection에 접근할 수도 있다.
~~~

<br>

이제는 만들어진 콜렉션에 문서를 삽입해야 된다.

<br>

~~~python
collection.inset_one({'test_1' : 'test_1', 'test_2', 'test_2'})

# 한번에 여러 문서를 삽입하려면 insert_many를 사용한다.
~~~

<br>

여기서 따로 id 값을 추가하지 않았는데, **MongoDB 에서는 _id라는 고유번호를 각 문서에 자동으로 생성한다.**

<br>

문서를 불러올 때는 `find_one` 과 `find` 를 사용한다. 단일 문서를 불러올때는 `find_one`, 여러 문서를 불러올 때는 `find` 를 사용한다. 더 많은 사용 법은 [pymongo](https://pymongo.readthedocs.io/en/stable/)에서 확인 가능하다